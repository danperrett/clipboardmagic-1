30818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

8b

30818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

MIGJAoGBAOCOSTE3WR+geLM9zkdk7JhSYxbbTFivzXhw6r3T65JRmalx9Jg0vCU98DvYAkmXcdn5VL3nu2C6nAwQ77Aavap/Y3m5o4sYyYk3yMOLROzG3VbWKiydjQ6+qI5XiaNJ2s3nMUP2YH6Wywoj2Wi9cORM0UK7cQpV5wlBL5Wz2xS9AgMBAAE=

00:e0:8e:49:31:37:59:1f:a0:78:b3:3d:ce:47:64:
                    ec:98:52:63:16:db:4c:58:af:cd:78:70:ea:bd:d3:
                    eb:92:51:99:a9:71:f4:98:34:bc:25:3d:f0:3b:d8:
                    02:49:97:71:d9:f9:54:bd:e7:bb:60:ba:9c:0c:10:
                    ef:b0:1a:bd:aa:7f:63:79:b9:a3:8b:18:c9:89:37:
                    c8:c3:8b:44:ec:c6:dd:56:d6:2a:2c:9d:8d:0e:be:
                    a8:8e:57:89:a3:49:da:cd:e7:31:43:f6:60:7e:96:
                    cb:0a:23:d9:68:bd:70:e4:4c:d1:42:bb:71:0a:55:
                    e7:09:41:2f:95:b3:db:14:bd

00e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd

AOCOSTE3WR+geLM9zkdk7JhSYxbbTFivzXhw6r3T65JRmalx9Jg0vCU98DvYAkmXcdn5VL3nu2C6nAwQ77Aavap/Y3m5o4sYyYk3yMOLROzG3VbWKiydjQ6+qI5XiaNJ2s3nMUP2YH6Wywoj2Wi9cORM0UK7cQpV5wlBL5Wz2xS9

30818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

MIGJAoGBAOCOSTE3WR+geLM9zkdk7JhSYxbbTFivzXhw6r3T65JRmalx9Jg0vCU98DvYAkmXcdn5VL3nu2C6nAwQ77Aavap/Y3m5o4sYyYk3yMOLROzG3VbWKiydjQ6+qI5XiaNJ2s3nMUP2YH6Wywoj2Wi9cORM0UK7cQpV5wlBL5Wz2xS9AgMBAAE=

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgjkkxN1kfoHizPc5HZOyYUmMW
20xYr814cOq90+uSUZmpcfSYNLwlPfA72AJJl3HZ+VS957tgupwMEO+wGr2qf2N5
uaOLGMmJN8jDi0Tsxt1W1iosnY0OvqiOV4mjSdrN5zFD9mB+lssKI9lovXDkTNFC
u3EKVecJQS+Vs9sUvQIDAQAB

30818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgjkkxN1kfoHizPc5HZOyYUmMW
20xYr814cOq90+uSUZmpcfSYNLwlPfA72AJJl3HZ+VS957tgupwMEO+wGr2qf2N5
uaOLGMmJN8jDi0Tsxt1W1iosnY0OvqiOV4mjSdrN5zFD9mB+lssKI9lovXDkTNFC
u3EKVecJQS+Vs9sUvQIDAQAB

30819f300d06092a864886f70d010101050003818d00


30819f300d06092a864886f70d010101050003818d0030818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

30819f300d06092a864886f70d010101050003818d00

30819f300d06092a864886f70d010101050003818d0030818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001


30819f300d06092a864886f70d010101050003818d00

30819f300d06092a864886f70d010101050003818d0030818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgjkkxN1kfoHizPc5HZOyYUmMW20xYr814cOq90+uSUZmpcfSYNLwlPfA72AJJl3HZ+VS957tgupwMEO+wGr2qf2N5uaOLGMmJN8jDi0Tsxt1W1iosnY0OvqiOV4mjSdrN5zFD9mB+lssKI9lovXDkTNFCu3EKVecJQS+Vs9sUvQIDAQAB

30819f300d06092a864886f70d010101050003818d0030818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001


30818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

30819f300d06092a864886f70d010101050003818d0030818902818100e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd0203010001

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgjkkxN1kfoHizPc5HZOyYUmMW20xYr814cOq90+uSUZmpcfSYNLwlPfA72AJJl3HZ+VS957tgupwMEO+wGr2qf2N5uaOLGMmJN8jDi0Tsxt1W1iosnY0OvqiOV4mjSdrN5zFD9mB+lssKI9lovXDkTNFCu3EKVecJQS+Vs9sUvQIDAQAB

-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgjkkxN1kfoHizPc5HZOyYUmMW
20xYr814cOq90+uSUZmpcfSYNLwlPfA72AJJl3HZ+VS957tgupwMEO+wGr2qf2N5
uaOLGMmJN8jDi0Tsxt1W1iosnY0OvqiOV4mjSdrN5zFD9mB+lssKI9lovXDkTNFC
u3EKVecJQS+Vs9sUvQIDAQAB
-----END PUBLIC KEY-----

encrypted

G2W2gTUSyUiA4VHj71s7xwZ2USm/F9z9Z/ZXv1TseRs768KhuaezZnEbqbAzNDshwv3gl5el0s6Y
DcWiAtft0DOoWWRQcNjKRByDSIvtk3gLnkceivWtl2QP8xd/5wlIvw6PJh2i12la0ZeXanFSeOOi
JDh6XGzfWP/gvfANF5Q=

0x1b, 0x65, 0xb6, 0x81, 0x35, 0x12, 0xc9, 0x48, 0x80, 0xe1, 0x51, 0xe3, 0xef, 0x5b, 0x3b, 0xc7, 0x06, 0x76, 0x51, 0x29, 0xbf, 0x17, 0xdc, 0xfd, 0x67, 0xf6, 0x57, 0xbf, 0x54, 0xec, 0x79, 0x1b, 0x3b, 0xeb, 0xc2, 0xa1, 0xb9, 0xa7, 0xb3, 0x66, 0x71, 0x1b, 0xa9, 0xb0, 0x33, 0x34, 0x3b, 0x21, 0xc2, 0xfd, 0xe0, 0x97, 0x97, 0xa5, 0xd2, 0xce, 0x98, 0x0d, 0xc5, 0xa2, 0x02, 0xd7, 0xed, 0xd0, 0x33, 0xa8, 0x59, 0x64, 0x50, 0x70, 0xd8, 0xca, 0x44, 0x1c, 0x83, 0x48, 0x8b, 0xed, 0x93, 0x78, 0x0b, 0x9e, 0x47, 0x1e, 0x8a, 0xf5, 0xad, 0x97, 0x64, 0x0f, 0xf3, 0x17, 0x7f, 0xe7, 0x09, 0x48, 0xbf, 0x0e, 0x8f, 0x26, 0x1d, 0xa2, 0xd7, 0x69, 0x5a, 0xd1, 0x97, 0x97, 0x6a, 0x71, 0x52, 0x78, 0xe3, 0xa2, 0x24, 0x38, 0x7a, 0x5c, 0x6c, 0xdf, 0x58, 0xff, 0xe0, 0xbd, 0xf0, 0x0d, 0x17, 0x94

http://www.di-mgt.com.au/xmldsig2.html 

4I5JMTdZH6B4sz3OR2TsmFJjFttMWK/NeHDqvdPrklGZqXH0mDS8JT3wO9gCSZdx2flUvee7YLqcDBDvsBq9qn9jebmjixjJiTfIw4tE7MbdVtYqLJ2NDr6ojleJo0nazecxQ/ZgfpbLCiPZaL1w5EzRQrtxClXnCUEvlbPbFL0=

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">?
??????<CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>?
??????<SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>?
??????<Reference URI="">?
????????<Transforms>?
??????????<Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>?
????????</Transforms>?
????????<DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>?
????????<DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>?
??????</Reference>?
????</SignedInfo>

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#"><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod><DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue></Reference></SignedInfo>

UWuYTYug10J1k5hKfonxthgrAR8

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#"><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod><DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue></Reference></SignedInfo>


<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">?
??????<CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>?
??????<SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>?
??????<Reference URI="">?
????????<Transforms>?
??????????<Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>?
????????</Transforms>?
????????<DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>?
????????<DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>?
??????</Reference>?
????</SignedInfo>

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">\n
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>\n
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>\n
      <Reference URI="">\n
        <Transforms>\n
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>\n
        </Transforms>\n
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>\n
        <DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>\n
      </Reference>\n
    </SignedInfo>

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">\n
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>\n
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>\n
      <Reference URI="">\n
        <Transforms>\n
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>\n
        </Transforms>\n
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>\n
        <DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>\n
      </Reference>\n
</SignedInfo>

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>
      <Reference URI="">
        <Transforms>
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>
        </Transforms>
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>
        <DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>
      </Reference>
</SignedInfo>

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>
      <Reference URI="">
        <Transforms>
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>
        </Transforms>
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>
        <DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>
      </Reference>
    </SignedInfo>

<SignedInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"></CanonicalizationMethod>
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod>
      <Reference URI="">
        <Transforms>
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></Transform>
        </Transforms>
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod>
        <DigestValue>UWuYTYug10J1k5hKfonxthgrAR8=</DigestValue>
      </Reference>
    </SignedInfo>

a25a06d339d68b625cd7383a932357889956a54e

4I5JMTdZH6B4sz3OR2TsmFJjFttMWK/NeHDqvdPrklGZqXH0mDS8JT3wO9gCSZdx2flUvee7YLqcDBDvsBq9qn9jebmjixjJiTfIw4tE7MbdVtYqLJ2NDr6ojleJo0nazecxQ/ZgfpbLCiPZaL1w5EzRQrtxClXnCUEvlbPbFL0=

CanonicalizationMethod

SignatureMethod

DigestMethod

<SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments"></CanonicalizationMethod><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod><DigestValue>qWwoAabPMZn8vva4BBXTqadKdtc=</DigestValue></Reference></SignedInfo>

0986bfb08343cab5f9024d85f02d16d2901da263


jkjjkj

0986bfb08343cab5f9024d85f02d16d2901da263

<SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments"></CanonicalizationMethod><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"></SignatureMethod><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"></DigestMethod><DigestValue>qWwoAabPMZn8vva4BBXTqadKdtc=</DigestValue></Reference></SignedInfo>

0x09, 0x86, 0xbf, 0xb0, 0x83, 0x43, 0xca, 0xb5, 0xf9, 0x02, 0x4d, 0x85, 0xf0, 0x2d, 0x16, 0xd2, 0x90, 0x1d, 0xa2, 0x63, 

G2W2gTUSyUiA4VHj71s7xwZ2USm/F9z9Z/ZXv1TseRs768KhuaezZnEbqbAzNDshwv3gl5el0s6Y
DcWiAtft0DOoWWRQcNjKRByDSIvtk3gLnkceivWtl2QP8xd/5wlIvw6PJh2i12la0ZeXanFSeOOi
JDh6XGzfWP/gvfANF5Q=

PEM_read_bio_RSA_PUBKEY(

BIO_new_mem_buf

PEM_read_bio_RSA_PUBKEY

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCqGKukO1De7zhZj6+H0qtjTkVxwTCpvKe4eCZ0
FPqri0cb2JZfXJ/DgYSF6vUpwmJG8wVQZKjeGcjDOL5UlsuusFncCzWBQ7RKNUSesmQRMSGkVb1/
3j+skZ6UtW+5u09lHNsj6tQ51s1SPrCBkedbNf0Tp0GbMJDyR4e9T04ZZwIDAQAB

RSA_generate_key

RSA_new

4I5JMTdZH6B4sz3OR2TsmFJjFttMWK/NeHDqvdPrklGZqXH0mDS8JT3wO9gCSZdx2flUvee7YLqcDBDvsBq9qn9jebmjixjJiTfIw4tE7MbdVtYqLJ2NDr6ojleJo0nazecxQ/ZgfpbLCiPZaL1w5EzRQrtxClXnCUEvlbPbFL0=




4I5JMTdZH6B4sz3OR2TsmFJjFttMWK/NeHDqvdPrklGZqXH0mDS8JT3wO9gCSZdx2flUvee7YLqcDBDvsBq9qn9jebmjixjJiTfIw4tE7MbdVtYqLJ2NDr6ojleJo0nazecxQ/ZgfpbLCiPZaL1w5EzRQrtxClXnCUEvlbPbFL0=

e08e493137591fa078b33dce4764ec98526316db4c58afcd7870eabdd3eb925199a971f49834bc253df03bd802499771d9f954bde7bb60ba9c0c10efb01abdaa7f6379b9a38b18c98937c8c38b44ecc6dd56d62a2c9d8d0ebea88e5789a349dacde73143f6607e96cb0a23d968bd70e44cd142bb710a55e709412f95b3db14bd

4I5JMTdZH6B4sz3OR2TsmFJjFttMWK/NeHDqvdPrklGZqXH0mDS8JT3wO9gCSZdx2flUvee7YLqcDBDvsBq9qn9jebmjixjJiTfIw4tE7MbdVtYqLJ2NDr6ojleJo0nazecxQ/ZgfpbLCiPZaL1w5EzRQrtxClXnCUEvlbPbFL0=

AQAB

BN_bin2bn

createNewRSAKEY

KeyValue

CHECKANDEXIT(KeyInfo);

signature->FirstChildElement("KeyValue");

RSAKeyValue

 CHECKANDEXIT(KeyValue);

CHECKANDEXIT(RSAKeyValue);

CHECKANDEXIT(Modulus);

CHECKANDEXIT(Exponent);

CheckAndCopyNewKey

CompareSignedInfoElement

		result	"<Envelope><Message><Header><Version><MessageFormat>message-v0.1</MessageFormat><Data>data-v0.1</Data><Software>software-v1</Software></Version><Time><Current>2015-10-13T15:46:20.9360961+01:00</Current><TimeStatus>SYNCHRONISED</TimeStatus><Monotonic>456657873</Monotonic></Time><SequenceNumber>0</SequenceNumber><SourceUnitID>ICONIS-1-Unit-A</SourceUnitID><LogicalSourceID>ICONIS-1</LogicalSourceID><SourceStatus>MASTER</SourceStatus><SourceLinkStatus>UP</SourceLinkStatus><DestinationUnitID>SRIF-1-Unit-A</DestinationUnitID><LogicalDestinationID>SRIF-1</LogicalDestinationID></Header><Body><Interlocking><UniqueID>4</UniqueID><SSIID>4</SSIID><ControlRequests>o6MBAAEA0Qs4GwEAAACqVWwBAQAAAD2ogcFObqOjAQABAHZGhC4BAAAAqlVOAQEAAAAWStZhS3CjowEAAQCdvDUuAQAAAKpVMAEBAAAAx3xkDQCio6MBAAEAOacsLgEAAACqVRIBAQAAADFDer0q9qOjAQABAMqm0y0BAAAAqlX0AAEAAABMi12byy+jowEAAQBQHdItAQAAAKpV1gABAAAAC/3qTadlo6MBAAEAhhfPLQEAAACqVbgAAQAAAEsY2xqgYqOjAQABAEluGS0BAAAAqlWaAAEAAADvdkxI54mjowEAAQAYsaIPAQAAAKpVfAABAAAAi8AJ3WVCo6MBAAEAN16DDwEAAACqVV4AAQAAALCwOYmKFqOjAQABADS7Zg8BAAAAqlVAAAEAAACPpPKOJkMwMTAyMDMwMDA0MDAwNTAwMDAwMDA2MDAwMDAwMDcwMDAyMDAwMDAwMDgwMDAwMDAwMDAwMDAwMDAwMDAzMDM5Mb2D9qd13nlN5kO98JcbAS+RYvcGDg==</ControlRequests></Interlocking><Interlocking><UniqueID>44</UniqueID><SSIID>34534</SSIID><ControlRequests>o6MBAAEA0Qs4GwEAAACqVUABAQAAAK8GYZj2QaOjAQABAHZGhC4BAAAAqlUiAQEAAAB2K/SnFgyjowEAAQCdvDUuAQAAAKpVBAEBAAAAufZ9dwboo6MBAAEAOacsLgEAAACqVeYAAQAAAAo34pp28KOjAQABAMqm0y0BAAAAqlXIAAEAAACM2JBlmv+jowEAAQBQHdItAQAAAKpVqgABAAAAgRa5uwSio6MBAAEAhhfPLQEAAACqVYwAAQAAAKb0W5dZxqOjAQABAEluGS0BAAAAqlVuAAEAAAAYmWLbAC6jowEAAQAYsaIPAQAAAKpVUAABAAAAAZL7pw8+MDIwMzA0MDAwNTAwMDYwMDAwMDAwNzAwMDAwMDA4MDAwYTAwMDAwMDA4MDAwMDAwMDAwMDAwMDAwMDAwMzAzNTMwMzYzMDM3MzAzODMwMzmHGw+XNZf9V8JaKMFVxwDplH8=</ControlRequests></Interlocking></Body></Message><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\" /><SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" /><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\" /></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /><DigestValue>W24h7QY6yFiVnX7u43KKEJXwWLA=</DigestValue></Reference></SignedInfo><SignatureValue>T19BUC1ziiADWox/Of3b8p3WWU4gZJQm6cP9qRRkiusTmhTX3uBLsjlXCi66mgooVVfd9nBOs87V5U0wXH0tz47Jas/UeNFkgMfyvU6Zvcxy+ceJhDWU1oFWXoB8pAR+wE4FANaSld6a6dgvlJo1KbOAQ429HOXEQJ3etVmI5WI=</SignatureValue></Signature></Envelope>"	string


 // Open the X.509 "Current User" store in read only mode.
                X509Store store = new X509Store(StoreLocation.CurrentUser);
                store.Open(OpenFlags.ReadOnly);

                // Place all certificates in an X509Certificate2Collection object.
                X509Certificate2Collection certCollection = store.Certificates;

                X509Certificate2 cert = null;

                // Loop through each certificate and find the certificate 
                // with the appropriate name.
                foreach (X509Certificate2 c in certCollection)
                {
                    if (c.Subject == "CN=XML_ENC_TEST_CERT")
                    {
                        cert = c;

                        break;
                    }
                }

using System.Security.Cryptography.X509Certificates;

 X509Certificate2 

// Close the store.
                store.Close();

 KeyInfo keyInfo = new KeyInfo();
        keyInfo.AddClause(new RSAKeyValue((RSA)Key));
        signedXml.KeyInfo = keyInfo;

   KeyInfo keyInfo = new KeyInfo();
        keyInfo.AddClause(new RSAKeyValue((RSA)Key));
        signedXml.KeyInfo = keyInfo;

rsaKey

		result	"<Envelope><Message><Header><Version><MessageFormat>message-v0.1</MessageFormat><Data>data-v0.1</Data><Software>software-v1</Software></Version><Time><Current>2015-10-13T16:30:41.7761535+01:00</Current><TimeStatus>SYNCHRONISED</TimeStatus><Monotonic>459318595</Monotonic></Time><SequenceNumber>0</SequenceNumber><SourceUnitID>ICONIS-1-Unit-A</SourceUnitID><LogicalSourceID>ICONIS-1</LogicalSourceID><SourceStatus>MASTER</SourceStatus><SourceLinkStatus>UP</SourceLinkStatus><DestinationUnitID>SRIF-1-Unit-A</DestinationUnitID><LogicalDestinationID>SRIF-1</LogicalDestinationID></Header><Body><Interlocking><UniqueID>4</UniqueID><SSIID>4</SSIID><ControlRequests>o6MBAAEAUqVgGwEAAACqVWwBAQAAAEC1bs9MLKOjAQABAHZGhC4BAAAAqlVOAQEAAAAWStZhS3CjowEAAQCdvDUuAQAAAKpVMAEBAAAAx3xkDQCio6MBAAEAOacsLgEAAACqVRIBAQAAADFDer0q9qOjAQABAMqm0y0BAAAAqlX0AAEAAABMi12byy+jowEAAQBQHdItAQAAAKpV1gABAAAAC/3qTadlo6MBAAEAhhfPLQEAAACqVbgAAQAAAEsY2xqgYqOjAQABAEluGS0BAAAAqlWaAAEAAADvdkxI54mjowEAAQAYsaIPAQAAAKpVfAABAAAAi8AJ3WVCo6MBAAEAN16DDwEAAACqVV4AAQAAALCwOYmKFqOjAQABADS7Zg8BAAAAqlVAAAEAAACPpPKOJkMwMTAyMDMwMDA0MDAwNTAwMDAwMDA2MDAwMDAwMDcwMDAyMDAwMDAwMDgwMDAwMDAwMDAwMDAwMDAwMDAzMDM5Mb2D9qd13nlN5kO98JcbAS+RYvfAaw==</ControlRequests></Interlocking><Interlocking><UniqueID>44</UniqueID><SSIID>34534</SSIID><ControlRequests>o6MBAAEAYqVgGwEAAACqVUABAQAAAL5Rj7+EQKOjAQABAHZGhC4BAAAAqlUiAQEAAAB2K/SnFgyjowEAAQCdvDUuAQAAAKpVBAEBAAAAufZ9dwboo6MBAAEAOacsLgEAAACqVeYAAQAAAAo34pp28KOjAQABAMqm0y0BAAAAqlXIAAEAAACM2JBlmv+jowEAAQBQHdItAQAAAKpVqgABAAAAgRa5uwSio6MBAAEAhhfPLQEAAACqVYwAAQAAAKb0W5dZxqOjAQABAEluGS0BAAAAqlVuAAEAAAAYmWLbAC6jowEAAQAYsaIPAQAAAKpVUAABAAAAAZL7pw8+MDIwMzA0MDAwNTAwMDYwMDAwMDAwNzAwMDAwMDA4MDAwYTAwMDAwMDA4MDAwMDAwMDAwMDAwMDAwMDAwMzAzNTMwMzYzMDM3MzAzODMwMzmHGw+XNZf9V8JaKMFVxwDpEAw=</ControlRequests></Interlocking></Body></Message><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\" /><SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" /><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\" /></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /><DigestValue>VARqQ9xg9Lqz1Ro6sdrDkSX41VM=</DigestValue></Reference></SignedInfo><SignatureValue>fgWwSOCF98omgU0Wx/+DnSH3tRsRkBZvCFrxgq+m6JoM95HaIryYEBqJ40S2dZ9N7TNh2M2cShT95s4/YNss3AwGjfRqolGUtopdqSB2HsBwYOGtfpDBLFiqIQ3SCPkapUTbhnKEXpNe5VGDHr2UTBhM+fF4T7avceJTmYDdv7I=</SignatureValue><KeyInfo><KeyValue><RSAKeyValue><Modulus>nOSFi662Uo072F+p1PTrAbPsI9NWrPnJag59kiYoP5fHHKiFkUy35omSrVCHupYDIxWViK+IpGKZF+I/QMUPn5Pyha1sRJEHDADLM6vxQEKw40PYWNfO7ect74XdUVbbE3KzqPgKB/QOzPo8aIjcQ8q/Ny1sF/O65lzur3VOh6c=</Modulus><Exponent>AQAB</Exponent></RSAKeyValue></KeyValue></KeyInfo></Signature></Envelope>"	string


KeyInfo

KeyValue

RSAKeyValue

XMLPrinter printer(NULL, true, 0);

XMLElement *KeyInfo = signature->FirstChildElement("KeyInfo");

char* xmlstring  = (char *)printer.CStr();

Dosha1Encode

CheckTheRSAEncryptionOfSignedInfo

key1

SetKey

Base64decode

nOSFi662Uo072F+p1PTrAbPsI9NWrPnJag59kiYoP5fHHKiFkUy35omSrVCHupYDIxWViK+IpGKZF+I/QMUPn5Pyha1sRJEHDADLM6vxQEKw40PYWNfO7ect74XdUVbbE3KzqPgKB/QOzPo8aIjcQ8q/Ny1sF/O65lzur3VOh6c=

Base64decode

rsaKey

 int  result = RSA_public_decrypt(data_len, enc_data, decrypted, rsa, padding);

signature->FirstChildElement("KeyInfo");

CHECKANDEXIT(KeyInfo);

SignatureValue

Base64decode(_exponent, exponent);

